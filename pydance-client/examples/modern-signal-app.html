<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modern Signal App - Pydance Client Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      font-weight: 300;
    }

    .header p {
      opacity: 0.9;
      font-size: 1.1em;
    }

    .demo-section {
      padding: 30px;
    }

    .counter-demo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-bottom: 40px;
      padding: 30px;
      background: #f8f9fa;
      border-radius: 12px;
    }

    .counter-display {
      font-size: 3em;
      font-weight: bold;
      color: #667eea;
      min-width: 120px;
      text-align: center;
    }

    .counter-btn {
      width: 50px;
      height: 50px;
      border: none;
      border-radius: 50%;
      background: #667eea;
      color: white;
      font-size: 1.5em;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .counter-btn:hover {
      background: #5a6fd8;
      transform: scale(1.1);
    }

    .counter-btn:active {
      transform: scale(0.95);
    }

    .todo-demo {
      margin-top: 40px;
    }

    .todo-input-section {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .todo-input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.2s ease;
    }

    .todo-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .todo-btn {
      padding: 12px 24px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .todo-btn:hover {
      background: #5a6fd8;
    }

    .todo-list {
      list-style: none;
    }

    .todo-item {
      display: flex;
      align-items: center;
      padding: 16px;
      background: #f8f9fa;
      margin-bottom: 8px;
      border-radius: 8px;
      transition: all 0.2s ease;
    }

    .todo-item:hover {
      background: #e9ecef;
    }

    .todo-checkbox {
      margin-right: 12px;
      width: 20px;
      height: 20px;
      accent-color: #667eea;
      cursor: pointer;
    }

    .todo-text {
      flex: 1;
      font-size: 16px;
    }

    .todo-text.completed {
      text-decoration: line-through;
      color: #6c757d;
    }

    .todo-delete {
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.2s ease;
    }

    .todo-delete:hover {
      background: #c82333;
    }

    .stats {
      margin-top: 20px;
      padding: 16px;
      background: #e9ecef;
      border-radius: 8px;
      text-align: center;
      color: #495057;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #6c757d;
    }

    .error {
      background: #f8d7da;
      color: #721c24;
      padding: 16px;
      border-radius: 8px;
      margin: 16px 0;
      border: 1px solid #f5c6cb;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üöÄ Pydance Client</h1>
      <p>Modern Signal-Based Frontend Framework Demo</p>
    </div>

    <div class="demo-section">
      <!-- Counter Demo -->
      <div class="counter-demo">
        <button class="counter-btn" id="decrement">-</button>
        <div class="counter-display" id="counter">0</div>
        <button class="counter-btn" id="increment">+</button>
      </div>

      <!-- Todo Demo -->
      <div class="todo-demo">
        <h2>üìù Todo List</h2>

        <div class="todo-input-section">
          <input
            type="text"
            class="todo-input"
            id="todo-input"
            placeholder="Add a new todo..."
          >
          <button class="todo-btn" id="add-todo">Add Todo</button>
        </div>

        <ul class="todo-list" id="todo-list">
          <!-- Todos will be added here -->
        </ul>

        <div class="stats" id="stats">
          Total todos: 0 | Active: 0 | Completed: 0
        </div>
      </div>
    </div>
  </div>

  <!-- Load Pydance Client Framework -->
  <script type="module">
    import { signal, computed, effect, createComponent } from '../src/index.js';

    // Counter component using signals
    const Counter = createComponent(() => {
      const count = signal(0);

      // Update counter display
      effect(() => {
        const display = document.getElementById('counter');
        if (display) {
          display.textContent = count.value;
        }
      });

      // Event listeners
      const increment = () => count.value++;
      const decrement = () => count.value--;

      document.getElementById('increment')?.addEventListener('click', increment);
      document.getElementById('decrement')?.addEventListener('click', decrement);

      return { count, increment, decrement };
    });

    // Todo component using signals
    const TodoApp = createComponent(() => {
      const todos = signal([]);
      const inputValue = signal('');

      // Computed stats
      const stats = computed(() => {
        const total = todos.value.length;
        const completed = todos.value.filter(todo => todo.completed).length;
        const active = total - completed;
        return { total, completed, active };
      });

      // Update stats display
      effect(() => {
        const statsElement = document.getElementById('stats');
        if (statsElement) {
          const { total, active, completed } = stats.value;
          statsElement.textContent = `Total todos: ${total} | Active: ${active} | Completed: ${completed}`;
        }
      });

      // Add todo
      const addTodo = () => {
        const text = inputValue.value.trim();
        if (text) {
          todos.value = [...todos.value, {
            id: Date.now(),
            text,
            completed: false
          }];
          inputValue.value = '';
        }
      };

      // Toggle todo completion
      const toggleTodo = (id) => {
        todos.value = todos.value.map(todo =>
          todo.id === id ? { ...todo, completed: !todo.completed } : todo
        );
      };

      // Delete todo
      const deleteTodo = (id) => {
        todos.value = todos.value.filter(todo => todo.id !== id);
      };

      // Update todo list display
      effect(() => {
        const todoList = document.getElementById('todo-list');
        if (todoList) {
          todoList.innerHTML = '';

          todos.value.forEach(todo => {
            const li = document.createElement('li');
            li.className = 'todo-item';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.className = 'todo-checkbox';
            checkbox.checked = todo.completed;
            checkbox.addEventListener('change', () => toggleTodo(todo.id));

            const span = document.createElement('span');
            span.className = `todo-text ${todo.completed ? 'completed' : ''}`;
            span.textContent = todo.text;

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'todo-delete';
            deleteBtn.textContent = '√ó';
            deleteBtn.addEventListener('click', () => deleteTodo(todo.id));

            li.appendChild(checkbox);
            li.appendChild(span);
            li.appendChild(deleteBtn);

            todoList.appendChild(li);
          });
        }
      });

      // Event listeners
      document.getElementById('add-todo')?.addEventListener('click', addTodo);
      document.getElementById('todo-input')?.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          addTodo();
        }
      });

      // Sync input value
      const input = document.getElementById('todo-input');
      if (input) {
        input.addEventListener('input', (e) => {
          inputValue.value = e.target.value;
        });

        // Initial sync
        inputValue.value = input.value;
      }

      return { todos, inputValue, addTodo, toggleTodo, deleteTodo, stats };
    });

    // Initialize components
    console.log('üöÄ Initializing Pydance Client Demo...');

    try {
      const counter = Counter();
      const todoApp = TodoApp();

      console.log('‚úÖ Demo components initialized successfully');
      console.log('üìä Counter signal:', counter.count);
      console.log('üìù Todo signal:', todoApp.todos);

    } catch (error) {
      console.error('‚ùå Failed to initialize demo:', error);
    }
  </script>
</body>
</html>
